@startuml

[*] --> 用户可见: 用户提交订单

state 用户可见 {
[*] --> 待付款

待付款 --> 取消: 用户拒绝付款 / 商品库存不足
取消 --> [*]
待付款 -> 商家可见: 用户付款

state 商家可见 {
[*] -> 待发货
待发货 -> 已发货: 商家确认订单并填入快递单号
已发货 -> 已完成: 用户确认收到 / 订单超时？
已完成 --> [*]
}
}

@enduml

